---
title: "Initialize Payment"
description: "Accept payments using the AcountPay SDK"
---

After setting up the SDK, you can initialize a payment flow to accept payments directly from your customers' bank accounts.

## Basic Payment Flow

```javascript
// Create payment request
acountPay.initiatePayment({
  amount: '499.95',         // Payment amount
  currency: 'DKK',          // Currency code
  reference: 'ORDER-123',   // Your internal reference
  description: 'Payment for Order #123', // Description shown to customer
})
.then(response => {
  // Handle successful payment initialization
  console.log('Payment initialized:', response);
  // response.id contains the payment ID you can use for status checks
})
.catch(error => {
  // Handle errors
  console.error('Payment initialization failed:', error);
});
```

## Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `amount` | `number` | âœ… Yes | Payment amount in smallest currency unit (Ã¸re for DKK, cents for EUR) |
| `referenceNumber` | `string` | âœ… Yes | Unique identifier for the payment |
| `onSuccess` | `function` | âœ… Yes | Called when payment completes: `(status: { success: true }) => void` |

## React Integration
If you're using React, you can use our hooks and components:
```javascript
import React from 'react';
import { useAcountPay, PaymentButton } from '@acountpay/sdk/react';

function CheckoutComponent() {
  const { initiatePayment } = useAcountPay();
  
  const handlePayment = async () => {
    try {
      const result = await initiatePayment({
        amount: '499.95',
        currency: 'DKK',
        reference: 'ORDER-123',
        description: 'Payment for Order #123',
      });
      
      // Handle successful payment
      console.log('Payment successful', result);
    } catch (error) {
      // Handle payment error
      console.error('Payment failed', error);
    }
  };
  
  return (
    <div>
      {/* Option 1: Use the built-in payment button */}
      <PaymentButton
        amount="499.95"
        currency="DKK"
        reference="ORDER-123"
        description="Payment for Order #123"
        onSuccess={result => console.log('Payment successful', result)}
        onError={error => console.error('Payment failed', error)}
      >
        Pay with AcountPay
      </PaymentButton>
      
      {/* Option 2: Use your own button with the hook */}
      <button 
        onClick={handlePayment}
        className="inline-flex items-center px-4 py-2 bg-green-800 rounded-md text-white hover:bg-green-900 transition-colors"
      >
        Pay with AcountPay
      </button>
    </div>
  );
}
```
Complete Example
Here's a complete example using React:
```javascript
import React, { useState, useEffect } from "react";
import { AcountPayClient } from '@acountpay/sdk';

export default function App() {
  const [acountPay, setAcountPay] = useState(null);

  useEffect(() => {
    const sdk = new AcountPayClient({
      clientId: process.env.REACT_APP_ACOUNTPAY_CLIENT_ID,
      environment: process.env.REACT_APP_ACOUNTPAY_ENV || 'sandbox',
      redirectUri: process.env.REACT_APP_ACOUNTPAY_REDIRECT_URI
    });
    setAcountPay(sdk);
  }, []);

  const handlePayment = async () => {
    if (!acountPay) return;
    
    try {
      await acountPay.initiatePayment({
        amount: '100',                         // 1.00 DKK
        currency: 'DKK',                       // Danish Krone
        reference: `REF-${Date.now()}`,        // Unique reference
        description: 'Test payment'            // Optional description
      });
    } catch (error) {
      console.error('Payment failed:', error);
      // Show error message to user
    }
  };

  return (
    <button 
      onClick={handlePayment} 
      disabled={!acountPay}
      className="px-4 py-2 bg-green-800 text-white rounded-md"
    >
      Pay with AcountPay
    </button>
  );
}
```

## Payment Flow Overview
When a payment is initiated:

- The SDK opens the payment flow UI (either in-page or in a new window)
- The customer selects their bank account
- The customer is redirected to their bank for authentication via MitID
- After successful authentication, the bank processes the payment
- The customer is redirected back to your redirect URI
- Your callback handler processes the payment result

## Handling Payment Results
Set up a callback handler at your redirect URI:
```javascript
// In your callback component/page
import { AcountPay } from '@acountpay/sdk';

// Parse the payment result from the URL
const paymentResult = AcountPay.parsePaymentResult(window.location.search);

if (paymentResult.success) {
  // Payment was successful
  console.log('Payment successful', paymentResult);
  // paymentResult.transactionId contains the transaction ID
  // paymentResult.reference contains your original reference
} else {
  // Payment failed
  console.error('Payment failed', paymentResult.error);
}
```

##Testing Payments
Use the sandbox environment for testing:

- Ensure REACT_APP_ACOUNTPAY_ENV=sandbox in your environment
- Use small amounts like 100 (1 DKK) for test payments
- Test different scenarios (success, failure, cancellation)
- Payments are domestic only - Denmark uses DKK, other countries use their local currency

## Error Handling
Always implement proper error handling:
```javascript
try {
  await acountPay.initiatePayment({
    amount: '100',
    currency: 'DKK',
    reference: 'ORDER-123',
  });
} catch (error) {
  if (error.code === 'payment_cancelled') {
    // User cancelled the payment
    console.log('Payment was cancelled by the user');
  } else if (error.code === 'insufficient_funds') {
    // Insufficient funds in the selected account
    console.log('Insufficient funds in the selected account');
  } else {
    // Other error
    console.error('Payment failed:', error.message);
  }
}
```
That's it! ðŸš€
