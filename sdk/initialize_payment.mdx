---
title: "Initialize Payment"
description: "Start the user payment flow via the AcountPay SDK (redirects to user.acountpay.com to link IBAN)"
---

After setting up the SDK, you can start the user-first flow. This redirects the customer to the AcountPay user portal to securely link IBAN and consent to payment, then returns them to your app.

## Basic User Flow

```typescript
import AcountPay from '@acountpay/sdk';

const sdk = new AcountPay({
  clientId: process.env.REACT_APP_ACOUNTPAY_CLIENT_ID!,
  // Optionally pass apiBaseUrl here, or set window.__ACOUNTPAY_API_URL__ in HTML
  // apiBaseUrl: '[https://acount-apis-7886a9e16dc3.herokuapp.com](https://acount-apis-7886a9e16dc3.herokuapp.com)',
});

localStorage.setItem('paymentType', 'user'); // optional tag used by demos

await sdk.initiateUserPaymentByEmail({
  amount: 1, // major units (1 = 1 DKK)
  requestId: 'PAY' + String(Math.random()).split('.')[1].slice(0, 6),
  callbackURL: process.env.REACT_APP_ACOUNTPAY_REDIRECT_URI!,
  // authToken: '<Bearer token>' // optional if your backend requires it
});
```

## Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `amount` | `number` | ✅ Yes | Payment amount in major currency units (e.g., 1 = 1 DKK) |
| `requestId` | `string` | ✅ Yes | Unique request identifier (e.g., PAY123456) |
| `callbackURL` | `string` | ✅ Yes | URL the user is returned to after the portal flow |
| `authToken` | `string` | No | Bearer token if your backend enforces authentication for this endpoint |

Endpoint called by the SDK:

POST {BASE}/sdk/users/{clientId}/payment-request
Body: { amount, requestId, callbackURL }
Success response should include: { redirectTo: "<URL>" } (SDK redirects the browser)

React Example

```typescript
import AcountPay from '@acountpay/sdk';

export function PayButton() {
  const handlePay = async () => {
    const sdk = new AcountPay({ clientId: process.env.REACT_APP_ACOUNTPAY_CLIENT_ID! });
    localStorage.setItem('paymentType', 'user');
    await sdk.initiateUserPaymentByEmail({
      amount: 1,
      requestId: 'PAY' + String(Math.random()).split('.')[1].slice(0, 6),
      callbackURL: process.env.REACT_APP_ACOUNTPAY_REDIRECT_URI!,
    });
  };

  return <button onClick={handlePay}>Pay with AcountPay</button>;
}
```

Flow Overview

The SDK requests a user payment from your backend.
Backend returns a redirectTo URL for the AcountPay user portal.
The browser is redirected to the portal:
User links IBAN to their account.
User authenticates and consents.
User is redirected back to your callbackURL.

Note

Ensure your app origin and callbackURL are whitelisted in your backend.
Amounts are major units (e.g., 1 = 1 DKK).
Provide a bearer token if your environment requires authentication.

Handling Results

After the user returns to your callbackURL:
Verify the payment state using your backend (recommended).
Optionally parse any query params your backend attaches to the redirect.
Display success/failure to the user based on your backend’s confirmation.

Troubleshooting

400 Bad Request: Check clientId, callbackURL, and amount units.
403 Forbidden: Likely missing/invalid Authorization token or disallowed client/origin.
No redirect: Ensure your backend returns { redirectTo } for the request.
